---
title: "Variance of Dice"
format: html
editor: visual
---

## Sampling

First, note that we may use the `sample` data from an arbitrary discrete distribution with relatively small support.  Read `help(sample)` for more, but the basic gist is that we give it the support `x`, the `size` (number of samples), a boolean `replace` which tells us if we sample with replacement or not (we will almost always use `TRUE` here since we want our samples to be independent), and `prob` is essentially the probability mass function.  In particular, the first element of `prob` is the probability of the first element of `x`, the second element of `prob` is the probability of the second element of `x` and so on.  We construct `x` and `prob` using the "combine" function `c`.  Note that we may omit `prob` if the distribution is uniform.  In other words, the following are equivalent:

```r
sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE, c(1/6, 1/6, 1/6, 1/6, 1/6, 1/6))
sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)
```

We used the longer version in class, but we'll use the shorter version in this document.

## Sample Variance of 2d6

Recall our goal:  to find the sample variance $S^2$ of 2d6, i.e, of i.i.d. random variables $X_1,X_2$ with the uniform distribution on $\{1,2,3,4,5,6\}$.

In class, we found that the probability mass function of $S^2$ is
$$
f_{S^2}(x) = \begin{cases}
\frac{1}{6} &\text{if }x = 0 \\
\frac{5}{18} &\text{if }x = \frac{1}{2} \\
\frac{2}{9} &\text{if }x = 2 \\
\frac{1}{6} &\text{if }x = \frac{9}{2} \\
\frac{1}{9} &\text{if }x = 8 \\
\frac{1}{18} &\text{if }x = \frac{25}{2} \\
0 &\text{otherwise.}
\end{cases}
$$

and that $E(S^2) = \frac{35}{12}$, which happens to be equal to $\operatorname{Var}(X_i)$.

## Monte Carlo Simulations

First, let's check the expected value.  Recall that to perform a Monte Carlo simulation, we use `mean(replicate(...))` to run our code a bunch of times and find the average value.

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE))))
35/12
```

Now let's check the values of our probability mass function.  Recall that by have a statement (e.g., `var(...) == 0`), `replicate(...)` spits out a bunch of booleans (`TRUE` and `FALSE)`, and `mean(...)` gives us the proportion of `TRUE`'s.  This gives us an estimate of the probability of that particular value.

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)) == 0))
1/6
```

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)) == 1/2))
5/18
```

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)) == 2))
2/9
```

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)) == 9/2))
1/6
```

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)) == 8))
1/9
```

```{r}
mean(replicate(10000, var(sample(c(1, 2, 3, 4, 5, 6), 2, replace = TRUE)) == 25/2))
1/18
```

## Binomial Distribution

We also started a second problem.  Suppose $X_1,X_2\sim B\left(3, \frac{1}{2}\right)$.  We computed

\begin{align}
$P(S^2 = 0) &= \sum_{k=0}^3 P(X_1 = k)P(X_2=k) \\
&= \sum_{k=0}^3\left(\binom{3}{k}\left(\frac{1}{2}\right)^k\left(\frac{1}{2}\right)^{3-k}\right)^2 \\
&= \sum_{k=0}\binom{3}{k}^2\frac{1}{64}\\
&= \frac{1}{64}\left(1^2 + 3^2 + 3^2 + 1^3\right) \\
&= \frac{5}{16}
\end{align}

Let's check this with a Monte Carlo simulation as well.  We may use the `rbinom` function.  It takes three arguments: the number of samples and then the $n$ and $p$ from our binomial distribution.  So we want to use `rbinom(2, 3, 1/2)`.

```{r}
mean(replicate(10000, var(rbinom(2, 3, 1/2)) == 0))
5/16
```
